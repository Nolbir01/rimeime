# 說明書 #

## 專題 ##

  * [認識 La Rime](Introduction.md)
  * [下載與安裝](Downloads.md)
  * [定製指南](CustomizationGuide.md)（初階）
  * [輸入方案設計書](RimeWithSchemata.md)（中階）
  * [程序開發](RimeWithTheCode.md)（高階）

## 第三方文檔 ##

  * [鼠鬚管試玩心得](http://bbs.weiphone.com/read-htm-tid-5108521.html)／lionhoho

## 導航 ##

  1. [使用方案選單](UserGuide#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%A1%88%E9%81%B8%E5%96%AE.md)
  1. [輸入法設定](UserGuide#%E8%BC%B8%E5%85%A5%E6%B3%95%E8%A8%AD%E5%AE%9A.md)
  1. [打字入門](UserGuide#%E6%89%93%E5%AD%97%E5%85%A5%E9%96%80.md)
    * 選字與換頁
    * 令輸入碼直接上屏
    * 使用編輯鍵
    * 刪除誤上屏的錯詞
    * Emacs 風格的編輯鍵
    * 輸入標點符號
    * 中西文切換
    * 繁簡字切換
  1. [預設輸入方案](UserGuide#%E9%A0%90%E8%A8%AD%E8%BC%B8%E5%85%A5%E6%96%B9%E6%A1%88.md)
    * 朙月拼音  語句流  雙拼  宮保拼音
    * 地球拼音  注音
    * 倉頡  速成  五筆
    * 粵拼  吳語
  1. [用戶詞典管理](http://code.google.com/p/rimeime/wiki/UserGuide#%E7%94%A8%E6%88%B6%E8%A9%9E%E5%85%B8%E7%AE%A1%E7%90%86)
    * 備份及合併詞典快照
    * 導出及導入文本碼表
    * 導入其他來源的碼表
    * 同步用戶資料

## 使用方案選單 ##

下載、安裝完成後，試試：

切換到 Rime 輸入法，按組合鍵 Ctrl+` 喚出輸入方案選單（常見於「1」的左方；Linux和Windows版本也可用 F4 鍵）。這裏有 Rime 輸入法最常用的選項。

Rime 預設輸入方案有：朙月拼音★、語句流★、倉頡★、速成、五筆、雙拼、地球拼音、注音、粵拼、吳語、中古漢語拼音、五筆畫、國際音標等。

您可立即從方案選單切換到標有★的幾款方案。

如果需要啓用其他的預設方案，或自定義方案，請：

## 輸入法設定 ##

參閱《[定製指南](CustomizationGuide.md)》，從中瞭解如何自定義方案選單、每頁候選個數等全局選項；修改界面外觀；以及調整輸入方案的工作方式如指定選字、換頁的按鍵、標點符號映射等。

目前僅【小狼毫】配有一組簡單的設定面板，包含輸入方案選單設定、界面風格設定、用戶詞典管理。其他發行版，以及其他以「輸入方案」爲中心的衆多選項，可通過修改配置文件後重新部署Rime的方式來定製。

## 打字入門 ##

以下操作多數是可定製的，此說明書以默認配置爲準。

### 選字與換頁 ###

使用 ↑↓鍵 定位高亮的候選字，以空格鍵確認。

在【語句流】風格的輸入方案裏，以空格鍵確認後，字詞並不立即上屏，而是在輸入了句末的標點（，。？！等）或按下回車鍵（`Return`）時整個句子上屏。

通常，按數字鍵可選擇序號爲該數字的候選；但某些輸入方案會以其他按鍵代替數字鍵，如【注音】以大寫字母選字。

除了可用標準的 `Page Up`、`Page Down` 換頁之外，大多數輸入方案裏還設置了以下幾組等效的換頁鍵：
  * `Shift+Tab`、`Tab`
  * 符號鍵 `- =`
  * 符號鍵 `, .`

### 令輸入碼直接上屏 ###

輸入編碼後，如果不需要候選字而是希望輸入碼對應的鍵盤字符直接上屏，可使用回車鍵（`Return`）。

注意：【語句流】輸入方案不適用。在【語句流】模式下，先按左Shift鍵切換爲西文編碼，再按回車鍵確認。

若要輸出經過變換的輸入碼，如帶聲調的地球拼音、注音符號、倉頡字母等，請在輸入編碼後按 `Shift`+回車鍵 或 `Control`+回車鍵。

### 使用編輯鍵 ###

使用 ←→鍵 定位光標插入點「›」，編輯輸入碼。
也可用來縮短後選詞所對應輸入碼的範圍、確認詞句的一部分。

`Home`、`End` 鍵 快速跳至句首、句末。

`BackSpace`、`Delete` 鍵 分別刪除光標前、後的編碼字符。注意在蘋果鍵盤上前者標註爲 `Delete`，後者通常是組合鍵 `Fn+Delete`。

`Escape` 鍵 清空未完成的輸入。

### 刪除誤上屏的錯詞 ###

不慎上屏了錯誤的詞組，再打同樣的編碼時，那錯詞出現在候選欄，令有潔癖的同學十分不爽。這時候可以：

先把選字光標（用上、下鍵）移到要刪除的用戶詞組上，再按下 `Shift+Delete` 或 `Control+Delete`（蘋果鍵盤用 `Shift+Fn+Delete`）。

只能夠從用戶詞典中刪除詞組。用於碼表中原有的詞組時，只會取消其調頻效果。

### Emacs 風格的編輯鍵 ###

註：Windows 版本 Alt 組合鍵不可用。

  * ↑：Control+p
  * ↓：Control+n
  * ←：Control+b
  * →：Control+f
  * 上頁：Alt+v
  * 下頁：Control+v
  * 句首：Control+a
  * 句末：Control+e
  * 回退：Control+h
  * 刪除：Control+d
  * 清空：Control+g
  * 刪詞：Control+k

### 輸入標點符號 ###

按鍵到標點符號的映射有三種形式：
  * 按鍵對應惟一的符號，按鍵後直接輸出該符號，如「，」
  * 按鍵對應一組配對的符號，符號交替出現，如「“”」
  * 按鍵對應多種符號，按鍵後展現選單。此時可按空格鍵或回車鍵確認高亮的符號，反復按該鍵則選中下一種符號。

每一款輸入方案，都可以定義兩套符號表，以「方案選單」裏的選項「半角←→全角」往復切換。

### 中西文切換 ###

打開「方案選單」，使用選項「中文←→西文」可在兩種轉換狀態間往復切換。

此外，默認可用左右 `Shift` 鍵快速切換。

在輸入了部分編碼的情況下，左 `Shift` 將這些編碼臨時轉還爲西文。編輯臨時轉換的西文並以回車鍵上屏後，自動回復中文狀態。

在輸入了部分編碼的情況下，右 `Shift` 將上屏當前的候選字，並進入西文模式。

以上可總結爲：左 `Shift` 切換輸入法光標左面的編碼內容，右 `Shift` 切換光標右面即將輸入的內容。

### 繁簡字切換 ###

Rime 輸入法詞庫多以傳統漢字編排。

因爲有opencc提供準確而高效的繁→簡轉換功能，大多數輸入方案都可以從「方案選單」裏選擇「漢字←→汉字」的選項來啓用或停用繁簡轉換。

碼表爲簡化字的方案如【五筆】、【袖珍簡化字拼音】等，不提供這個選項。

## 預設輸入方案 ##

### 朙月拼音 ###

與時下流行的拼音輸入法相近。默認安裝後將使用此方案。
其詞典包含 Rime 內置的【八股文】繁體詞庫。設有繁簡轉換的開關。

以下有若干輸入方案衍生自朙月拼音，如【語句流】、各式雙拼、【宮保拼音】。還有不少方案使用朙月拼音作反查碼。

《[定製指南](CustomizationGuide.md)》提供了模糊音定製方法及代碼模板。

### 語句流 ###

揉合了語句輸入的按鍵習慣，以及詞組輸入逐詞確認的操作節奏。

句中空格鍵的運用，既起到明確詞邊界、彌補長句轉換精度不足的作用，又很好地模仿了西文以空格斷詞的慣用法。

配合 Mac、IBus 版本內嵌預編輯文字的特性，體驗更佳。

### 雙拼 ###

基於【朙月拼音】製作了幾種流行的雙拼方案：自然碼、MSPY、智能ABC、紫光、小鶴雙拼等。

雙拼與【朙月拼音】、語句流輸入方案共用一份碼表和用戶詞典。

實現雙拼的關鍵，是用 Rime 的「拼寫運算」技術建立雙拼輸入碼到全拼的映射表，從而對接朙月拼音詞典。在《[輸入方案設計書](RimeWithSchemata.md)》中有一個完整的代碼示例。

### 宮保拼音 ###

仍是基於【朙月拼音】，採用源自西方速錄技術的多鍵並擊方式，雙手共七指操作鍵盤，一擊輸入一個拼音音節。

宮保拼音 / `Combo Pinyin` 自從2007年創製以來，經歷10個版本，孜孜以求一套直觀易用，並且兼顧PC鍵盤上操作舒適度的鍵位佈局。

[宮保拼音專題介紹](ComboPinyin.md)

註：【宮保拼音】方案目前僅可用於 Linux 和 Windows 版本的 Rime 輸入法。Mac 版本暫時無法實現。

### 地球拼音 ###

支持標註聲調的拼音輸入法。

以形似的符號  - / < \ 附加在拼音音節的末尾，分別表示陰平、陽平、上聲、去聲。輕聲不標。

爲按鍵方便故，也可使用 ; / , \ 來標註。

聲調、韻母在輸入常用短語時可以省略，而成爲簡拼。因此本方案既兼容了無聲調拼音輸入法的打字習慣，又可在輸入生僻字詞時通過輸入聲調篩選出同音同調者。

因爲對應相同的音系，【地球拼音】與【注音】共享詞典，卻不與【朙月拼音】相通。

### 注音 ###

注音符號輸入法。使用最廣泛的「大千式」鍵盤排佈。

但其操作層面不同於傳統的注音輸入法，而是採取「無模式」的設計，與 Rime 裏的其他輸入方案達成統一。
所謂「無模式」，是指輸入注音碼，會即時顯示出候選字，而不似傳統的注音輸入法需要另行呼出選字窗口。

Rime【注音】輸入方案，允許省略聲調（包含作爲第一聲的空格鍵）以及某些音節（非零聲母且聲母不能自成音節者）的韻母部分。
當省略聲調時，可連續輸入後一個音節，或間以隔音符號「 ' 」表明前一音節結束。

此外，【注音】採用了語句流的按鍵習慣，以回車鍵確認上屏；在輸入了聲調的音節後，以空格鍵選定高亮的字詞。

爲了在輸入注音碼的同時展現候選字，候選的序號改爲大寫字母ABCDE等，以避開定義爲注音符號的數字鍵。
要選用當頁第二個候選字，可按↓鍵、再按空格鍵選定第二字，又可按下 Shift+B 鍵直接選取。

一些標點符號由於所在按鍵用作輸入注音符號的原因而有所調整：
  * 逗號， `Shift+,`
  * 句號。 `Shift+.`
  * 分號； `Shift+;`
  * ／號  `Shift+/`
  * 減號  `Shift+-`
規則很簡單：符號鍵被注音字母佔用時，加打上檔鍵 Shift 從符號列表中選取。

### 倉頡 ###

第五代倉頡輸入法。

默認，通過倉頡碼檢出的候選字限制在「通用字符集」，排除了 Unicode CJKV 擴展區漢字。

需要輸入大量古字、生僻字的專業用戶，請在「方案選單」中切換一次形如「通用 → 增廣」的字符集過濾開關，即可輸入七萬餘簡繁漢字。

註：您的系統可能需要安裝專門的字體方可正確顯示漢字全集。參考《[定製指南](CustomizationGuide.md)》爲 Rime 輸入法設定用於顯示候選文字的字體。

以拼音輸入單字、常用詞組，可反查倉頡碼。需要安裝【朙月拼音】以啓用反查。倉頡碼與拼音重碼時，倉頡碼查到的候選字優先。
亦可按引導鍵 ` 進入拼音反查。

看到候選字一旁有「陰陽魚 ☯」記號？

`:-D` 這表示，該候選詞組並不存在於碼表中，而是通過「混元編碼器」產生、或由已知字碼自動組合而成的結果。您需要確認一下這是否恰是你想要的詞。
Rime 的後續版本將不斷改進算法，在輸入碼未命中碼表時，推測出更有意義的文字，越來越「懂我心意」。

### 速成 ###

取倉頡首尾二碼，簡單快速地連續輸入詞、句，且支持倉頡全碼、速成碼混合輸入。編碼雖是基於字形，智能組詞、調頻等特性與拼音輸入法別無二致。

### 五筆 ###

五筆字型86版。簡化字優先，兼收繁體字。包含小規模的詞庫。

敲 z 鍵開始轉爲簡體拼音字詞輸入，反查五筆編碼。需要安裝【袖珍簡化字拼音】以啓用反查。

另有【五筆・拼音】混合輸入的方案。在這款方案裏，可直接以五筆或拼音碼輸入字、詞而無須轉換。輸入拼音碼時，若候選字、詞編入了五筆碼表，則在候選字一旁提示其五筆碼。

### 粵拼 ###

以[「香港語言學會粵語拼音方案（粵拼）」](http://www.lshk.org/cantonese.php)輸入廣府話。

敲引導鍵 ` 之後，開始輸入漢語拼音（普通話）反查粵拼。需要安裝【朙月拼音】以啓用反查。

輸入不完整的粵拼編碼、或當拼寫錯誤被自動糾正時，候選字、詞加註完整的粵拼編碼提示。（注意：由於碼表並未全部經過人工校對，程序自動注音的結果可能使提示中多音字的標註出現錯誤！請不要把輸入法的提示當作標準學習而受誤導！）

### 吳語 ###

以[「吳語拉丁式注音法」](http://input.foruto.com/wu/method.html)輸入上海話。

敲引導鍵 ` 之後，開始輸入漢語拼音（普通話）反查吳語拼寫。需要安裝【朙月拼音】以啓用反查。

《定製指南》提供了模糊音定製方法及模板。

## 用戶詞典管理 ##

從【小狼毫】開始菜單或托盤圖標的右鍵菜單中打開「用戶詞典管理」介面。

左側列表爲已使用的用戶詞典，以詞典名表示，如 `luna_pinyin` 。
注意詞典與輸入方案可能是一對多的關係。

### 命令行工具 ###

【中州韻】和【鼠鬚管】暫無圖形工具，可取得 librime 編譯產出的工具程序 `bin/rime_dict_manager` 通過命令行方式實現以下功能。

執行 `rime_dict_manager` 之前需要關閉正在使用的輸入法，釋放以獨佔方式打開的詞典文件。

請，將工作目錄設爲「Rime 用戶資料夾」。在此執行 `rime_dict_manager` 查看所支持的參數及命令格式；加上參數 `--list` 查看用戶詞典列表。

### 備份及合併詞典快照 ###

Rime 輸入法在使用中會在一定時間自動將用戶詞典備份爲快照文件 `*.userdb.txt` 。
也可使用管理工具，備份指定的用戶詞典到快照文件。

備份到快照中的打字習慣，可回復到新建立的或其他系統上的用戶詞典。

執行合併詞典快照操作，只須選定要合併的 `.userdb.txt` 文件，因爲快照中已記錄了所屬詞典的名稱。

你不必擔心來自快照的詞條已存在於用戶詞典的情況；詞頻更新爲二者的較大值，其他參數亦會按照合理的算法疊加。

### 導出及導入文本碼表 ###

將用戶詞典導出爲文本碼表，便於直接閱讀，或批量添加詞條到 `*.dict.yaml` 。

導出的文本格式與 Rime 靜態碼表的格式相同：以製表符（Tab）分隔的三列，分別是文字、編碼、使用頻次。其中，編碼是碼表中定義的完全形式，多個音節間以空格。

如此導出的文本碼表，可反向導入到指定的用戶詞典。但是，文本碼表所含信息不如快照全面，因此爲了不損失輸入效果，請儘量使用 **合入快照** 的方式轉移用戶資料。

由於文本碼表用戶可以編輯，導入時無法檢查碼表內容是否與選定的詞典相匹配，請 **當心** 莫要導入到錯誤的詞典中去了。

### 導入其他來源的碼表 ###

首先，如果來源是一份比較完整的（比方說拼音）詞庫，則使用了該碼表的輸入方案，已成爲一種「新品牌」的拼音輸入方案。

因此建議，將此碼表製成 Rime 詞典用在自定義輸入方案裏；而不是把他導入朙月拼音（繁體）或簡化字拼音的用戶詞典。

要點是：
  * 將碼表改寫爲 `my_pinyin.dict.yaml` ；詞典名 `my_pinyin` 與預設的拼音詞典不重名，設定部分可照抄
  * 參考預設的拼音輸入方案，建立 `my_pinyin.schema.yaml` ；設定與其相關聯的詞典名：
```
    # ...
    translator:
      dictionary: my_pinyin
```
  * 個人修改版的 `my_pinyin.*.yaml` 放置在「用戶資料夾」；參考《[定製指南](CustomizationGuide#%E4%B8%80%E4%BE%8B%E3%80%81%E5%AE%9A%E8%A3%BD%E6%96%B9%E6%A1%88%E9%81%B8%E5%96%AE.md)》啓用新方案、完成部署

---

如果你認定要將碼表導入已存在的用戶詞典，則要注意：
  1. 碼表文件的格式是否 Rime 所要求的 UTF-8 (no BOM) 編碼
  1. 文本行是否爲製表符分隔，至少有文字、編碼兩列，及一列可選的頻次
  1. 文字的字形（繁、簡字）是否與源碼表一致
  1. 編碼的形式是否源碼表中定義的標準形式

第一點，有一臺專業的文本編輯器就控制住啦。比如VIM裏面用命令
```
:se fenc=utf8 nobomb ff=unix
```
轉換、保存文件就中啦。

第二點，如果來源文件的資料格式不同，就需要藉助 regex 批量替換的操作，或寫腳本來完成轉換。

只有詞條、沒有編碼？請重新考慮先時我提出的建議。因爲，製作固態詞典，可以利用【八股文】，以及自動編碼器。

第三點，如果字形與目標詞典不一致，推薦用 [opencc](http://code.google.com/p/opencc/) 完成碼表的繁、簡轉換。

第四點，凡是編碼爲源碼表中未出現過的形式，如通過「拼寫運算」實現的簡拼、異拼，又如編碼中的拼寫錯誤，都將導致該條記錄成爲用戶詞典中的無效數據，因爲無法通過正常的輸入檢索到。

### 同步用戶資料 ###

藉助移動存儲設備，或在線存儲服務如Dropbox，在多臺電腦及不同系統之間同步用戶詞典和用戶設定。

#### 設定同步位置 ####

默認地，詞典快照備份到 RIME用戶文件夾\sync\UUID 這個地方。如果你要用 Dropbox 或 U盤在不同機器/系統之間同步用戶詞典，則需要設定同步的目標文件夾，如 `D:\Dropbox\RimeSync` 。

直接編輯用戶文件夾下的 `installation.yaml` ，添加：
```
sync_dir: 'D:\Dropbox\RimeSync'
```
又如 Mac 上添加：
```
sync_dir: '/Users/fred/Dropbox/RimeSync'
```
又如使用 USB 存儲來同步：（[真實案例](https://gist.github.com/4483504)）
```
sync_dir: '/Volumes/USBDRIVE/RimeSync'
```

默認地，每套 Rime 會隨機生成一個 UUID 作爲標識。不同 installation ID 可區分來自不同機器/系統的用戶詞典。

與安裝在其他系統上的 Rime 同步後，同步文件夾呈如下佈局：
```
D:\Dropbox\RimeSync\id-xxx\luna_pinyin.userdb.txt
D:\Dropbox\RimeSync\id-xxx\terra_pinyin.userdb.txt
D:\Dropbox\RimeSync\id-xxx\installation.yaml
D:\Dropbox\RimeSync\id-xxx\default.custom.yaml
D:\Dropbox\RimeSync\id-xxx\weasel.custom.yaml

D:\Dropbox\RimeSync\id-yyy\terra_pinyin.userdb.txt
D:\Dropbox\RimeSync\id-yyy\installation.yaml
D:\Dropbox\RimeSync\id-yyy\default.custom.yaml
D:\Dropbox\RimeSync\id-yyy\squirrel.custom.yaml

D:\Dropbox\RimeSync\id-zzz\luna_pinyin.userdb.txt
D:\Dropbox\RimeSync\id-zzz\installation.yaml
D:\Dropbox\RimeSync\id-zzz\alternative.yaml
D:\Dropbox\RimeSync\id-zzz\luna_pinyin.custom.yaml
```
同步時，依次將各子文件夾中的詞典快照合併到用戶詞典，最後爲合併後的用戶詞典生成一份新的快照文件。
另外，還會把用戶文件夾中非自動生成的 YAML 文件及 .txt 文件單向 **備份** 到同步文件夾。

有些特別講究命名的用家，不喜隨機生成的 UUID，可編輯 `installation.yaml` ，取一個有意義的 ID，如：
```
installation_id: 'fred-win7-desktop'
```
又如：
```
installation_id: 'fred-macbook'
```

當心！因爲 Rime 要以這個 ID 爲名創建文件夾，因此 ID 不得包含（所有涉及同步的文件系統）文件名中非法的字符；建議不要用中文，只用小寫字母、數字、橫線和下劃線。